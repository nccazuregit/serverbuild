Consider;

1 main template and 2 linked templates.

Main template will create all resources apart from VM..
There will be 2 different VM creation linked templates... one for a normal VM and one for a VM in an Availability set

These sub templates would be called conditionally... if AVSET name is selected, call the 'VM in AV Set' else call the 'BASIC VM'

Replace the VM resource with 2 linked template resource types...
	Condition for on one = AVSETName <> ""